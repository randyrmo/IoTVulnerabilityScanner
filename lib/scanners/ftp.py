from .scanner import ProtocolScanner
import ftplib

class FTPScanner(ProtocolScanner):
	def __init__(self, protocolName, portNumber, IPAddress):
		super(FTPScanner, self).__init__(protocolName, portNumber, IPAddress)
	#have to finish the function signature. And find out what's host and port
	def verifyCredentials(self, credentials):
		try:
			ftp = ftplib.FTP()
			ftp.connect(self.IPAddress, self.portNumber)
			ftp.login(credentials.getUsername(), credentials.getPassword())
			# ftp.sendcmd("uname -a")
			evidence = ftp.retrlines('LIST')
			ftp.quit()
			print(evidence)
			return evidence
		except:
			return None