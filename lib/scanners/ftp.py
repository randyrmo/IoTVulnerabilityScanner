from .scanner import ProtocolScanner
import ftplib

class FTPScanner(ProtocolScanner):
	def __init__(self, protocolName, portNumber, IPAddress):
		super(FTPScanner, self).__init__(protocolName, portNumber, IPAddress)
	#have to finish the function signature. And find out what's host and port
	def verifyCredentials(self, credentials):
		try:
			ftp = ftplib.FTP()
			ftp.connect(self.IPAddress, self.portNumber)
			ftp.login(credentials.getUsername(), credentials.getPassword())
			# ftp.sendcmd("uname -a")
			# evidence = ftp.retrlines('LIST')
			ftp.quit()
			evidence = "Modify raspberry system command to get appropr evidence for FTP"
			evidence = "Linux raspberrypi 4.14.69+ #1141 Mon Sep 10 15:13:50 BST 2018 armv6l GNU/Linux"
			print(evidence)
			return evidence
		except:
			return None